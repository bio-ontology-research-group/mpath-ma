# mpath-ma

## This folder contains the files needed to perform the following tasks:
## Generating MAP, MAPT, PAM, PAMT ontologies:
  for this task you can regenerate those ontologies using the generatePAM_MAP.groovy. 
  
  You can also specify the following optional arguments:
   
   **-m**: to select MA ontology as a primary axis of classification for the ontology, if not selected it will be MPATH
   
   **-t**: to select  the transitivity option
   
   to generate MAP : 
   ```
   generatePAM_MAP.groovy -m -o MAP.owl
   ```
   to generate MAPT : 
   ```
   generatePAM_MAP.groovy -m -t -o MAPT.owl
   ```
   to generate PAM : 
   ```
   generatePAM_MAP.groovy -o PAM.owl
   ```
   to generate PAMT : 
   ```
   generatePAM_MAP.groovy -t -o PAMT.owl
   ```
   ## OQuaRE measures:
   To compute TMOnto, WMCOnto and DITOnto we used OQuaRE_measures.groovy
   
   ## Compute semantic similarity:
   To compute semantic similarity we used the following files:
   
   MpathMAAnnotations.groovy  to generate the annotations
   
   piarwiseSimMpathMa.groovy  to generate the mouse to mouse similarity matrix
   
   ## Clustering, clustering purity, Area under purity curves:
   we applied four methods for clustering in this analysis: complete linkage(CL), Unweighted Pair Group Method with Arithmetic Mean(UPGMA),
   neighbor joining(NJ) and K-medoids using the following files and folders:
   
   clustering and statistical analysis/NJ_CL_UPGMA_clustering.m
   
   clustering and statistical analysis/k_medoids_clustering.R
   
   clustering and statistical analysis/similarities
   
   clustering and statistical analysis/mice.csv
  
   ## Kendall's tau:
   we calculated Kendall's tau for the p-values generated by the enrichment analysis using the following files and folders:
   
   clustering and statistical analysis/kendall.py
   
   clustering and statistical analysis/EAcode 
   
   ## ROC and ROC AUC:
   for plotting ROC curves and calculating ROC-AUC we used the following files and folders:
   
   clustering and statistical analysis/ROC_curves_and_ROC_AUC.m
   
   clustering and statistical analysis/similarities
   
   clustering and statistical analysis/mice.csv   
   
   ## Wilcoxon rank sum test:
   for calculating Wilcoxon rank sum test we used the following files and folders:
   
   clustering and statistical analysis/wilcoxonSumRankTest.m
   
   clustering and statistical analysis/similarities
   
   clustering and statistical analysis/mice.csv    

## Mapping and Over-representation Analysis:
We implemented a pipeline to map mouse data to multiple ontologies and perform age-controlled over-representation analysis (ORA).

### Mapping Generation
To generate a comprehensive TSV mapping file including IRIs for MA, MPATH, PAM, and MAP:
```bash
export JAVA_OPTS="--add-opens java.base/java.lang=ALL-UNNAMED"
groovy script/generateMappings.groovy
```
This script processes the raw mouse data and produces `mouse_mappings.tsv`.

### Statistical Analysis (ORA)
To perform the over-representation analysis controlling for categorical age bins (6M, 12M, 20M, LONG) and using the **True Path Rule** for ontology propagation:
```bash
# Extract ontology hierarchies
groovy analysis/extract_hierarchy.groovy

# Run statistical analysis and generate visualizations
uv run --with pandas --with scipy --with matplotlib --with tabulate analysis/perform_stats.py
```

### Analysis Results
Detailed results and documentation can be found in the `analysis/` folder:
- **analysis/RQ.md**: Research Question and methodology summary.
- **analysis/stats_summary.md**: Summary of the most significant non-trivial findings.
- **analysis/enrichments_python_tpr.tsv**: Complete table of 2,300+ significant enrichments.
- **analysis/top_enrichments_tpr.png**: Visualization of top enrichment ratios.
   
